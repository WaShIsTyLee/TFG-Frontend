<ion-header class="header-dark">
  <ion-toolbar>
    <ion-title>Perfil</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="dark-background">
  <div class="profile-container">
    <div class="profile-wrapper" *ngIf="usuarioActual">
      
      <!-- Sección de foto de perfil -->
      <div class="profile-photo-section">
        <div class="photo-container">
          <img *ngIf="fotoPerfil; else sinFoto" [src]="fotoPerfil" alt="Foto de perfil" class="profile-photo" />
          <ng-template #sinFoto>
            <div class="no-photo">
              <ion-icon name="person-outline" class="no-photo-icon"></ion-icon>
              <p class="no-photo-text">Sin foto de perfil</p>
            </div>
          </ng-template>
        </div>
        <button class="btn-change-photo" (click)="takeProfilePhoto()">
          <ion-icon name="camera-outline"></ion-icon>
          <span>Cambiar foto</span>
        </button>
      </div>

      <!-- Formulario de datos personales -->
      <div class="profile-form">
        <h3 class="section-title">
          <ion-icon name="person-outline" class="section-icon"></ion-icon>
          Datos Personales
        </h3>

        <div class="form-fields">
          <ion-item lines="none" class="profile-item">
            <ion-icon slot="start" name="person-outline" class="field-icon"></ion-icon>
            <ion-label position="floating">Nombre</ion-label>
            <ion-input [(ngModel)]="usuarioActual.name" type="text"></ion-input>
          </ion-item>

          <ion-item lines="none" class="profile-item">
            <ion-icon slot="start" name="mail-outline" class="field-icon"></ion-icon>
            <ion-label position="floating">Email</ion-label>
            <ion-input [(ngModel)]="usuarioActual.email" type="email"></ion-input>
          </ion-item>

          <ion-item lines="none" class="profile-item">
            <ion-icon slot="start" name="lock-closed-outline" class="field-icon"></ion-icon>
            <ion-label position="floating">Contraseña</ion-label>
            <ion-input [(ngModel)]="usuarioActual.password" type="password"></ion-input>
          </ion-item>

          <ion-item lines="none" class="profile-item">
            <ion-icon slot="start" name="call-outline" class="field-icon"></ion-icon>
            <ion-label position="floating">Teléfono</ion-label>
            <ion-input [(ngModel)]="usuarioActual.phone" type="tel"></ion-input>
          </ion-item>
        </div>
      </div>

      <!-- Sección de monedero -->
      <div class="wallet-section">
        <h3 class="section-title">
          <ion-icon name="wallet-outline" class="section-icon"></ion-icon>
          Monedero
        </h3>

        <div class="wallet-info">
          <div class="current-balance">
            <span class="balance-label">Saldo actual:</span>
            <span class="balance-amount">{{ usuarioActual.monedero }}€</span>
          </div>

          <ion-item lines="none" class="profile-item">
            <ion-icon slot="start" name="cash-outline" class="field-icon"></ion-icon>
            <ion-label position="floating">Añadir fondos</ion-label>
            <ion-input [(ngModel)]="fondosAAgregar" type="number" placeholder="0.00"></ion-input>
          </ion-item>

          <button class="btn-add-funds" (click)="agregarFondos()">
            <ion-icon name="add-circle-outline"></ion-icon>
            <span>Añadir al monedero</span>
          </button>
        </div>
      </div>

      <!-- Botones de acción -->
      <div class="action-buttons">
        <button class="btn-save" (click)="updateUserProfile()">
          <ion-icon name="checkmark-outline"></ion-icon>
          <span>Guardar cambios</span>
        </button>

        <button class="btn-logout" (click)="logout()">
          <ion-icon name="log-out-outline"></ion-icon>
          <span>Cerrar sesión</span>
        </button>
      </div>

    </div>
  </div>
</ion-content>